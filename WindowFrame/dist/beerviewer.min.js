"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}},Experience,AdmiralRank;define("vendor/vue.tippy",["require","exports","vue","tippy.js"],function(require,exports,vue_1,tippy_js_1){Object.defineProperty(exports,"__esModule",{value:!0}),vue_1=__importDefault(vue_1),tippy_js_1=__importDefault(tippy_js_1);const TIPPY=function(el,binding,vnode){const handlers=vnode.data&&vnode.data.on||vnode.componentOptions&&vnode.componentOptions.listeners,opts=Object.assign({reactive:!1,showOnLoad:!1},binding.value||{});if(handlers&&handlers.show&&(opts.onShow=(()=>handlers.show.fns(el,vnode))),handlers&&handlers.shown&&(opts.onShown=(()=>handlers.shown.fns(el,vnode))),handlers&&handlers.hidden&&(opts.onHidden=(()=>handlers.hidden.fns(el,vnode))),handlers&&handlers.hide&&(opts.onHide=(()=>handlers.hide.fns(el,vnode))),opts.html){const selector=opts.html;if(opts.reactive||"string"!=typeof selector)opts.html=selector instanceof Element?selector:selector instanceof vue_1.default?selector.$el:document.querySelector(selector);else{const elem=document.querySelector(opts.html);if(!elem)return void console.error(`[TippyExt] Selector "${opts.html}" not found`);elem._tipppyReferences?elem._tipppyReferences.push(el):elem._tipppyReferences=[el]}}{let opt=Object.assign({},tippy_js_1.default.defaults,opts);for(let i in opt)i in tippy_js_1.default.defaults||delete opt[i];tippy_js_1.default(el,opt)}opts.showOnLoad&&el._tippy.show(),vue_1.default.nextTick(()=>{handlers&&handlers.init&&handlers.init.fns(el._tippy,el)})},VueTippy={install(Vue,options){Vue.directive("tippy-target",{componentUpdated:function(el){const refs=el._tipppyReferences;refs&&refs.length>0&&Vue.nextTick(()=>{refs.filter(x=>x._tippy).forEach(ref=>{if(ref._tippy){const content=ref._tippy.popper.querySelector(".tippy-content");content.innerHTML=el.innerHTML}})})},unbind:function(el){delete el._tipppyReference}}),Vue.directive("tippy",{inserted:function(el,binding,vnode){Vue.nextTick(()=>TIPPY(el,binding,vnode))},unbind:function(el){el._tippy&&el._tippy.destroy()},componentUpdated:function(el,binding,vnode){const ts=JSON.stringify,opts=binding.value||{},oldOpts=binding.oldValue||{};el._tippy&&(ts(opts)!==ts(oldOpts)&&Vue.nextTick(()=>TIPPY(el,binding,vnode)),el._tippy.popperInstance&&(opts.show?el._tippy.show():opts.show||"manual"!==opts.trigger||el._tippy.hide()))}})}};exports.default=VueTippy}),define("System/Base",["require","exports","tippy.js","vue","vendor/vue.tippy"],function(require,exports,tippy_js_2,vue_2,vue_tippy_js_1){Object.defineProperty(exports,"__esModule",{value:!0}),tippy_js_2=__importDefault(tippy_js_2),vue_2=__importDefault(vue_2),vue_tippy_js_1=__importDefault(vue_tippy_js_1),tippy_js_2.default.setDefaults({arrow:!0,boundary:"viewport",placement:"bottom",size:"large",theme:"light-border",interactive:!1,trigger:"mouseenter focus",hideOnClick:!1,performance:!0}),vue_2.default.directive("dom",function(el,binding){binding.oldValue&&binding.oldValue instanceof Element&&binding.oldValue.parentNode===el&&binding.oldValue.remove(),binding.value instanceof Element&&el.append(binding.value)}),vue_2.default.use(vue_tippy_js_1.default,tippy_js_2.default.defaults)}),function(Experience){Experience.Admiral={1:{Level:1,Next:100,Total:0},2:{Level:2,Next:200,Total:100},3:{Level:3,Next:300,Total:300},4:{Level:4,Next:400,Total:600},5:{Level:5,Next:500,Total:1e3},6:{Level:6,Next:600,Total:1500},7:{Level:7,Next:700,Total:2100},8:{Level:8,Next:800,Total:2800},9:{Level:9,Next:900,Total:3600},10:{Level:10,Next:1e3,Total:4500},11:{Level:11,Next:1100,Total:5500},12:{Level:12,Next:1200,Total:6600},13:{Level:13,Next:1300,Total:7800},14:{Level:14,Next:1400,Total:9100},15:{Level:15,Next:1500,Total:10500},16:{Level:16,Next:1600,Total:12e3},17:{Level:17,Next:1700,Total:13600},18:{Level:18,Next:1800,Total:15300},19:{Level:19,Next:1900,Total:17100},20:{Level:20,Next:2e3,Total:19e3},21:{Level:21,Next:2100,Total:21e3},22:{Level:22,Next:2200,Total:23100},23:{Level:23,Next:2300,Total:25300},24:{Level:24,Next:2400,Total:27600},25:{Level:25,Next:2500,Total:3e4},26:{Level:26,Next:2600,Total:32500},27:{Level:27,Next:2700,Total:35100},28:{Level:28,Next:2800,Total:37800},29:{Level:29,Next:2900,Total:40600},30:{Level:30,Next:3e3,Total:43500},31:{Level:31,Next:3100,Total:46500},32:{Level:32,Next:3200,Total:49600},33:{Level:33,Next:3300,Total:52800},34:{Level:34,Next:3400,Total:56100},35:{Level:35,Next:3500,Total:59500},36:{Level:36,Next:3600,Total:63e3},37:{Level:37,Next:3700,Total:66600},38:{Level:38,Next:3800,Total:70300},39:{Level:39,Next:3900,Total:74100},40:{Level:40,Next:4e3,Total:78e3},41:{Level:41,Next:4100,Total:82e3},42:{Level:42,Next:4200,Total:86100},43:{Level:43,Next:4300,Total:90300},44:{Level:44,Next:4400,Total:94600},45:{Level:45,Next:4500,Total:99e3},46:{Level:46,Next:4600,Total:103500},47:{Level:47,Next:4700,Total:108100},48:{Level:48,Next:4800,Total:112800},49:{Level:49,Next:4900,Total:117600},50:{Level:50,Next:5e3,Total:122500},51:{Level:51,Next:5200,Total:127500},52:{Level:52,Next:5400,Total:132700},53:{Level:53,Next:5600,Total:138100},54:{Level:54,Next:5800,Total:143700},55:{Level:55,Next:6e3,Total:149500},56:{Level:56,Next:6200,Total:155500},57:{Level:57,Next:6400,Total:161700},58:{Level:58,Next:6600,Total:168100},59:{Level:59,Next:6800,Total:174700},60:{Level:60,Next:7e3,Total:181500},61:{Level:61,Next:7300,Total:188500},62:{Level:62,Next:7600,Total:195800},63:{Level:63,Next:7900,Total:203400},64:{Level:64,Next:8200,Total:211300},65:{Level:65,Next:8500,Total:219500},66:{Level:66,Next:8800,Total:228e3},67:{Level:67,Next:9100,Total:236800},68:{Level:68,Next:9400,Total:245900},69:{Level:69,Next:9700,Total:255300},70:{Level:70,Next:1e4,Total:265e3},71:{Level:71,Next:10400,Total:275e3},72:{Level:72,Next:10800,Total:285400},73:{Level:73,Next:11200,Total:296200},74:{Level:74,Next:11600,Total:307400},75:{Level:75,Next:12e3,Total:319e3},76:{Level:76,Next:12400,Total:331e3},77:{Level:77,Next:12800,Total:343400},78:{Level:78,Next:13200,Total:356200},79:{Level:79,Next:13600,Total:369400},80:{Level:80,Next:14e3,Total:383e3},81:{Level:81,Next:14500,Total:397e3},82:{Level:82,Next:15e3,Total:411500},83:{Level:83,Next:15500,Total:426500},84:{Level:84,Next:16e3,Total:442e3},85:{Level:85,Next:16500,Total:458e3},86:{Level:86,Next:17e3,Total:474500},87:{Level:87,Next:17500,Total:491500},88:{Level:88,Next:18e3,Total:509e3},89:{Level:89,Next:18500,Total:527e3},90:{Level:90,Next:19e3,Total:545500},91:{Level:91,Next:2e4,Total:564500},92:{Level:92,Next:22e3,Total:584500},93:{Level:93,Next:25e3,Total:606500},94:{Level:94,Next:3e4,Total:631500},95:{Level:95,Next:4e4,Total:661500},96:{Level:96,Next:6e4,Total:701500},97:{Level:97,Next:9e4,Total:761500},98:{Level:98,Next:148500,Total:851500},99:{Level:99,Next:3e5,Total:1e6},100:{Level:100,Next:0,Total:1e6},101:{Level:101,Next:1e4,Total:101e4},102:{Level:102,Next:1e3,Total:1011e3},103:{Level:103,Next:2e3,Total:1013e3},104:{Level:104,Next:3e3,Total:1016e3},105:{Level:105,Next:4e3,Total:102e4},106:{Level:106,Next:5e3,Total:1025e3},107:{Level:107,Next:6e3,Total:1031e3},108:{Level:108,Next:7e3,Total:1038e3},109:{Level:109,Next:8e3,Total:1046e3},110:{Level:110,Next:9e3,Total:1055e3},111:{Level:111,Next:1e4,Total:1065e3},112:{Level:112,Next:12e3,Total:1077e3},113:{Level:113,Next:14e3,Total:1091e3},114:{Level:114,Next:16e3,Total:1107e3},115:{Level:115,Next:18e3,Total:1125e3},116:{Level:116,Next:2e4,Total:1145e3},117:{Level:117,Next:23e3,Total:1168e3},118:{Level:118,Next:26e3,Total:1194e3},119:{Level:119,Next:29e3,Total:1223e3},120:{Level:120,Next:32e3,Total:1255e3},121:{Level:121,Next:35e3,Total:129e4},122:{Level:122,Next:39e3,Total:1329e3},123:{Level:123,Next:43e3,Total:1372e3},124:{Level:124,Next:47e3,Total:1419e3},125:{Level:125,Next:51e3,Total:147e4},126:{Level:126,Next:55e3,Total:1525e3},127:{Level:127,Next:59e3,Total:1584e3},128:{Level:128,Next:63e3,Total:1647e3},129:{Level:129,Next:67e3,Total:1714e3},130:{Level:130,Next:71e3,Total:1785e3},131:{Level:131,Next:75e3,Total:186e4},132:{Level:132,Next:8e4,Total:194e4},133:{Level:133,Next:85e3,Total:2025e3},134:{Level:134,Next:9e4,Total:2115e3},135:{Level:135,Next:95e3,Total:221e4},136:{Level:136,Next:1e5,Total:231e4},137:{Level:137,Next:105e3,Total:2415e3},138:{Level:138,Next:11e4,Total:2525e3},139:{Level:139,Next:115e3,Total:264e4},140:{Level:140,Next:12e4,Total:276e4},141:{Level:141,Next:127e3,Total:2887e3},142:{Level:142,Next:134e3,Total:3021e3},143:{Level:143,Next:141e3,Total:3162e3},144:{Level:144,Next:148e3,Total:331e4},145:{Level:145,Next:155e3,Total:3465e3},146:{Level:146,Next:163e3,Total:3628e3},147:{Level:147,Next:171e3,Total:3799e3},148:{Level:148,Next:179e3,Total:3978e3},149:{Level:149,Next:187e3,Total:4165e3},150:{Level:150,Next:195e3,Total:436e4},151:{Level:151,Next:204e3,Total:4564e3},152:{Level:152,Next:213e3,Total:4777e3},153:{Level:153,Next:222e3,Total:4999e3},154:{Level:154,Next:231e3,Total:523e4},155:{Level:155,Next:24e4,Total:547e4}}}(Experience||(Experience={}));class Settings{}function fns(Handler,...Params){Handler&&(Handler.length?Handler.forEach(x=>"function"==typeof x&&x(...Params)):"function"==typeof Handler&&Handler(...Params))}function using(resource,func){try{func(resource)}finally{resource.Dispose()}}function SubscribeKcsapi(url,callback){window.API.SubscribeHTTP("/kcsapi/"+url,(x,y)=>{try{const svdata=x.startsWith("svdata=")?x.substr(7):x,json=JSON.parse(svdata.toString());1===json.api_result&&callback&&callback(json.api_data,y)}catch(e){console.warn("Expected json, but not.",e)}})}class Notifier{constructor(){this.PropertyChanged=null}RaisePropertyChanged(propertyName=null){if(null!==this.PropertyChanged)if(this.PropertyChanged.length){const list=this.PropertyChanged;list.forEach(x=>x(propertyName))}else this.PropertyChanged(propertyName)}PropertyEvent(PropertyName,Handler,RaiseRegistered=!1){null===this.PropertyChanged&&(this.PropertyChanged=(x=>{x===PropertyName&&Handler&&Handler()})),RaiseRegistered&&Handler&&Handler()}}class TickNotifier extends Notifier{constructor(){super(),this.handler=setInterval(this.Tick,1e3)}Tick(){}Dispose(){clearInterval(this.handler)}}class Ticker{constructor(){this.handler=setInterval(this.Tick,1e3)}Tick(){}Dispose(){clearInterval(this.handler)}}class RawDataWrapper{constructor(RawData){this._raw=RawData}get raw(){return this._raw}UpdateData(RawData){this._raw=RawData}}!function(AdmiralRank){AdmiralRank[AdmiralRank.FleetAdmiral=1]="FleetAdmiral",AdmiralRank[AdmiralRank.Admiral=2]="Admiral",AdmiralRank[AdmiralRank.ViceAdmiral=3]="ViceAdmiral",AdmiralRank[AdmiralRank.RearAdmiral=4]="RearAdmiral",AdmiralRank[AdmiralRank.Captain=5]="Captain",AdmiralRank[AdmiralRank.Commander=6]="Commander",AdmiralRank[AdmiralRank.Novice_Commander=7]="Novice_Commander",AdmiralRank[AdmiralRank.Lieutenant_Commander=8]="Lieutenant_Commander",AdmiralRank[AdmiralRank.Vice_Lieutenant_Commander=9]="Vice_Lieutenant_Commander",AdmiralRank[AdmiralRank.Novice_Lieutenant_Commander=10]="Novice_Lieutenant_Commander"}(AdmiralRank||(AdmiralRank={}));class Admiral extends RawDataWrapper{get MemberId(){return this.raw.api_member_id}get Nickname(){return this.raw.api_nickname}get Comment(){return this.raw.api_comment}get Level(){return this.raw.api_level}get Rank(){return this.raw.api_rank}get Experience(){return this.raw.api_experience}get ExperienceForNextLevel(){return Experience.Admiral[this.raw.api_level+1].Total-this.raw.api_experience}get SortieWins(){return this.raw.api_st_win}get SortieLoses(){return this.raw.api_st_lose}get SortieWinningRate(){const battleCount=this.SortieWins+this.SortieLoses;return 0===battleCount?0:this.SortieWins/battleCount}get MaximumShips(){return this.raw.api_max_chara}get MaximumEquips(){return this.raw.api_max_slotitem}get ResourceLimit(){return 250*(this.raw.api_level+3)}constructor(data){super(data),SubscribeKcsapi("api_port/port",x=>this.UpdateData(x.api_basic)),SubscribeKcsapi("api_req_member/updatecomment",(x,y)=>this.raw.api_comment=y.api_cmt)}}class Homeport{constructor(){this.Admiral=null,this.Materials=null,this.Ships=[]}}Homeport.Instance=new Homeport;class Materials{get Fuel(){return this._Fuel}get Ammo(){return this._Ammo}get Steel(){return this._Steel}get Bauxite(){return this._Bauxite}get InstantConstruction(){return this._InstantConstruction}get RepairBucket(){return this._RepairBucket}get DevelopmentMaterial(){return this._DevelopmentMaterial}get ImprovementMaterial(){return this._ImprovementMaterial}constructor(){this._Fuel=0,this._Ammo=0,this._Steel=0,this._Bauxite=0,this._InstantConstruction=0,this._RepairBucket=0,this._DevelopmentMaterial=0,this._ImprovementMaterial=0,SubscribeKcsapi("api_port/port",x=>this.Update(x.api_material)),SubscribeKcsapi("api_get_member/material",x=>this.Update(x)),SubscribeKcsapi("api_req_hokyu/charge",x=>this.Update(x.api_material)),SubscribeKcsapi("api_req_kousyou/destroyship",x=>this.Update(x.api_material)),SubscribeKcsapi("api_req_kousyou/destroyitem2",x=>this.Update(x.api_get_material)),SubscribeKcsapi("api_req_air_corps/supply",x=>this.Update([x.api_after_fuel,this.Ammo,this.Steel,x.api_after_bauxite])),SubscribeKcsapi("api_req_air_corps/set_plane",(x,y)=>{"-1"!==y.api_item_id&&(x.api_plane_info.length>=2||this.Update([this.Fuel,this.Ammo,this.Steel,x.api_after_bauxite]))})}Update(source){if(!source||0==source.length)return;const type=typeof source[0].api_value;if(source.length>=4&&"undefined"===type){const casted=source;this._Fuel=casted[0],this._Ammo=casted[1],this._Steel=casted[2],this._Bauxite=casted[3]}else if(source.length>=8&&"undefined"!==type){const casted=source;this._Fuel=casted[0].api_value,this._Ammo=casted[1].api_value,this._Steel=casted[2].api_value,this._Bauxite=casted[3].api_value,this._InstantConstruction=casted[4].api_value,this._RepairBucket=casted[5].api_value,this._DevelopmentMaterial=casted[6].api_value,this._ImprovementMaterial=casted[7].api_value}}}class RepairDock{constructor(){this.Docks=[],SubscribeKcsapi("api_get_member/ndock",x=>this.Update(x)),SubscribeKcsapi("api_req_nyukyo/start",(x,y)=>this.Start(y)),SubscribeKcsapi("api_req_nyukyo/speedchange",(x,y)=>this.ChangeSpeed(y))}Update(source){this.Docks.length===source.length?source.forEach(raw=>this.Docks[raw.api_id].Update(raw)):(this.Docks.forEach(dock=>dock.Dispose()),this.Docks=source.map(x=>new RepairDock.Dock(x)))}Start(request){const ship=Homeport.Instance.Ships[request.api_ship_id];ship&&1===request.api_highspeed&&ship.Repair()}ChangeSpeed(request){try{const dock=this.Docks[request.api_ndock_id],ship=dock.Ship;dock.Finish(),ship&&ship.Repair()}catch(_a){}}}!function(RepairDock){let DockState;!function(DockState){DockState[DockState.Locked=-1]="Locked",DockState[DockState.Free=0]="Free",DockState[DockState.Repairing=1]="Repairing"}(DockState=RepairDock.DockState||(RepairDock.DockState={}));class Dock extends TickNotifier{constructor(dock){super(),this.notified=!1,this.Completed=null,this.Id=-1,this.State=DockState.Locked,this.ShipId=-1,this._Ship=null,this.CompleteTime=0,this.Remaining=0,this.Update(dock)}get Ship(){return this._Ship}set Ship(ship){this._Ship&&(this._Ship.Situation&=~Ship.Situation.Repairing),ship&&(ship.Situation|=Ship.Situation.Repairing),this._Ship=ship}Update(ndock){this.Id=0}Finish(){this.State=RepairDock.DockState.Free,this.ShipId=-1,this.Ship=null,this.CompleteTime=0}Tick(){if(0!==this.CompleteTime){let remaining=this.CompleteTime-Date.now();remaining<0&&(remaining=0),this.Remaining=remaining,!this.notified&&this.Completed&&remaining<=1e3*Settings.NotificationTime&&(fns(this.Completed,this,this.Id,this.Ship),this.notified=!0)}else this.Remaining=0}}RepairDock.Dock=Dock}(RepairDock||(RepairDock={}));class Ship{constructor(){this.Situation=Ship.Situation.None}Repair(){}}!function(Ship){let Situation;!function(Situation){Situation[Situation.None=0]="None",Situation[Situation.Repairing=1]="Repairing",Situation[Situation.Evacuation=2]="Evacuation",Situation[Situation.Tow=4]="Tow",Situation[Situation.HeavilyDamaged=8]="HeavilyDamaged",Situation[Situation.DamageControlled=16]="DamageControlled"}(Situation=Ship.Situation||(Ship.Situation={}))}(Ship||(Ship={}));